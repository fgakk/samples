<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Backbone Spring Mongo Sample</title>
         <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.1.1/css/bootstrap.min.css">
    </head>
    <body>
    	<div class="container">
    		<h1>Content Manager</h1>	
    	<br />
    	<div class="page"></div>
    	</div>
    	<script type="text/template" id="content-list-template">
    		<table class="table striped">
    			<thead>
    				<tr>
    					<th>Title</th>
    					<th>Content</th>
    					<th></th>
    				</tr>
    			</thead>
    			<tbody>
    				<% _.each(contents, function(content) { %>
    					<tr>
    						<td><%= content.get('title')%></td>
    						<td><%= content.get('content')%></td>
    						<td></td>
    					</tr>
    				<% }); %>
    			</tbody>
    		</table>
    	</script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script>
        <script>
         $.ajaxPrefilter( function( options, originalOptions, jqXHR ) {
      		options.url = 'http://localhost:8080' + options.url;
    	});
        	var Contents = Backbone.Collection.extend({
        		url:'/content'
        	});
        	var ContentList = Backbone.View.extend({
        		el: '.page',
        		render: function() {
        			var contents = new Contents();
        			var that = this;
        			contents.fetch({
        				success: function(contents) {
        					var template = _.template($('#content-list-template').html());
        					that.$el.html(template({contents:contents.models}));		
        				}
        			});
        			
        		}
        	});
        	var Router = Backbone.Router.extend({
        		routes:{
        			'' : 'home'
        		}
        	});
        	var contentList = new ContentList();
        	var router = new Router();
        	router.on('route:home', function() {
        		contentList.render();
        	});
        	Backbone.history.start();
        </script>
    </body>
</html>
